---
sidebar_position: 6
title: Common Modules
description: Documented common modules for plugins
---

export const DiscordAPIDocs = (props) => {
  const url = "https://discord.com/developers/docs/resources/" + props.link;
  return <a href={url}>{props.name}</a>;
};

export const APIReferences = {
  Guild: () => <DiscordAPIDocs name="Guild" link="guild#guild-object-guild-structure" />,
};

:::caution

All props/parameters are optional unless they say **(required)**.

:::

## Stores

### `channels`

### `guilds`

Functions:

| Name                       | Parameters                       | Return Type                             | Description                                                              |
| -------------------------- | -------------------------------- | --------------------------------------- | ------------------------------------------------------------------------ |
| `getGuild`                 | `guildId`: string                | <APIReferences.Guild /> \| undefined    | Gets the guild by its id                                                 |
| `getGuildCount`            |                                  | number                                  | Returns the number of how many guilds the user is in                     |
| `getGuildId`               |                                  | string \| undefined                     | Returns the id of the currently selected guild                           |
| `getGuilds`                |                                  | Record<string, <APIReferences.Guild />> | Gets all guilds                                                          |
| `getLastSelectedGuildId`   |                                  | string \| undefined                     | Returns the last selected guild id                                       |
| `getLastSelectedTimestamp` | `guildId`: string **(required)** | number                                  | Returns the timestamp of when a specific guild was last selected         |
| `getState`                 |                                  | `State`                                 | Returns an object containing some information about guild selections     |
| `getTabsV2SelectedGuildId` |                                  | string \| undefined                     | Returns the id of the last selected guild or the first guild in the list |
| `isLoaded`                 |                                  | boolean                                 | Returns a value indicating whether all initial guilds have been loaded   |
| `getCurrentGuild`          |                                  | <APIReferences.Guild /> \| undefined    | Gets the current selected guild by its id                                |

`State` Props:

| Name                           | Type                   | Description                                               |
| ------------------------------ | ---------------------- | --------------------------------------------------------- |
| `lastSelectedGuildId`          | string                 | Last selected guild id                                    |
| `selectedGuildId`              | string                 | Current selected guild id                                 |
| `selectedGuildTimestampMillis` | Record<string, number> | Object containing timestamps of when guilds were selected |

### `messages`

### `users`

## Utility

### `api`

Functions:

| Name            | Parameters                          | Return Type | Description                    |
| --------------- | ----------------------------------- | ----------- | ------------------------------ |
| `delete`        | `req`: `RequestOpts` **(required)** | `Response`  | Fetch with DELETE method       |
| `get`           | `req`: `RequestOpts` **(required)** | `Response`  | Fetch with GET method          |
| `getAPIBaseURL` | `version`: boolean                  | string      | Returns Discord's base API URL |
| `patch`         | `req`: `RequestOpts` **(required)** | `Response`  | Fetch with PATCH method        |
| `post`          | `req`: `RequestOpts` **(required)** | `Response`  | Fetch with POST method         |
| `put`           | `req`: `RequestOpts` **(required)** | `Response`  | Fetch with PUT method          |

`RequestOpts` Props:

| Name      | Type                    | Description             |
| --------- | ----------------------- | ----------------------- |
| `body`    | Record<string, unknown> | Body for the request    |
| `headers` | Record<string, string>  | Headers for the request |
| `query`   | Record<string, string>  | Request queries         |
| `url`     | string **(required)**   | URL to fetch from       |

`Response` Props:

| Name      | Type                   | Description                          |
| --------- | ---------------------- | ------------------------------------ |
| `body`    | unknown                | Body contents                        |
| `headers` | Record<string, string> | Headers associated with the response |
| `ok`      | boolean                | Whether the response was successful  |
| `status`  | number                 | Status code of the response          |
| `text`    | string                 | Response body in text                |

### `constants`

Props:

| Name             | Type                                | Description                                                                              |
| ---------------- | ----------------------------------- | ---------------------------------------------------------------------------------------- |
| `CSSVariables`   | Record<string, string>              | CSS variables                                                                            |
| `ColorGenerator` | [`ColorMod`](common#colorgenerator) | Utility module containing functions useful for generating colors from a given saturation |
| `Paths`          | Record<string, string>              | Paths                                                                                    |
| `Permissions`    | Record<string, bigint>              | Permissions                                                                              |
| `raw`            | Record<string, unknown>             | Raw module with all constants; check out its contents with DevTools                      |
| `RPCCommands`    | Record<string, string>              | RPC commands                                                                             |
| `RPCErrors`      | Record<string, string \| number>    | RPC errors                                                                               |
| `RPCEvents`      | Record<string, string>              | RPC events                                                                               |
| `Scopes`         | Record<string, string>              | Scopes                                                                                   |
| `Status`         | Record<string, string>              | User statuses                                                                            |
| `Themes`         | Record<string, string>              | Client themes; alias of `constants.ColorGenerator.themes`                                |

#### `ColorGenerator`

Example:

In the following example we will generate a color based on the original value of the
`BACKGROUND_PRIMARY` variable but with the saturation multiplied by `2`.

```tsx
import { common } from "replugged";
const { constants } = common;
const { ColorGenerator, Themes } = constants;

ColorGenerator.colors.BACKGROUND_PRIMARY.resolve({ theme: Themes.DARK, saturation: 2 });
```

Props:

| Name               | Type                             | Description                                                                                                                    |
| ------------------ | -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------ |
| `colors`           | Record<string, `Color`>          | Contains all CSS variables with the corresponding function to generate a color based on a given saturation                     |
| `themes`           | Record<string, string>           | Client themes                                                                                                                  |
| `unsafe_rawColors` | Record<string, `UnsafeRawColor`> | Contains all CSS variables for specific colors with the corresponding function to generate a color based on a given saturation |

### `contextMenu`

:::info

`contextMenu` is still a work in progress.

:::

### `flux`

### `fluxDispatcher`

### `i18n`

### `modal`

Enums:

:::info

The following enums are a shortcut to the [`Flex`](components#flex) component enums.

:::

| Enum              | Description                                                                      |
| ----------------- | -------------------------------------------------------------------------------- |
| `modal.Align`     | Flexbox alignments <br />`START` \| `END` \| `CENTER` \| `STRETCH` \| `BASELINE` |
| `modal.Direction` | Flexbox directions <br />`VERTICAL` \| `HORIZONTAL` \| `HORIZONTAL_REVERSE`      |
| `modal.Justify`   | Flexbox justifies <br />`START` \| `END` \| `CENTER` \| `BETWEEN` \| `AROUND`    |
| `modal.Wrap`      | Flexbox wraps <br />`NO_WRAP` \| `WRAP` \| `WRAP_REVERSE`                        |

Functions:

| Name         | Parameters                                                                                                                 | Return Type              | Description                                                                  |
| ------------ | -------------------------------------------------------------------------------------------------------------------------- | ------------------------ | ---------------------------------------------------------------------------- |
| `alert`      | `props`: `AlertProps` **(required)**                                                                                       |                          | Brings up a modal useful for a quick response                                |
| `closeModal` | `modalKey`: string **(required)** <br /> `contextKey`: string                                                              |                          | Closes a specific modal by its key                                           |
| `confirm`    | `props`: `AlertProps` **(required)**                                                                                       | Promise<boolean \| null> | Brings up an alert modal useful for asking the user for a quick confirmation |
| `openModal`  | `render`: (`props`: `ModalProps`) => ReactNode **(required)** <br /> `options`: `ModalOptions` <br /> `contextKey`: string | string                   | Opens a specific modal and returns its key                                   |

:::info

The `confirm` function has `title`, `cancelText`, `onConfirm`, `onCancel` and `onCloseCallback` with
a default value. Closing the modal determines the return value of the promise. For example, clicking
the confirm button of the modal, the promise value will be `true`.

Example:

```tsx
import { common } from "replugged";
const { modal } = common;

modal.confirm({}).then((confirmed) => {
  if (confirmed) console.log("Confirmed!");
  else console.log("Cancelled!");
});
```

:::

`AlertProps` Props:

| Name                   | Type                    | Default               | Description                                    |
| ---------------------- | ----------------------- | --------------------- | ---------------------------------------------- |
| `body`                 | boolean \| ReactElement |                       | Modal content                                  |
| `cancelText`           | string                  |                       | Text for the cancel button                     |
| `className`            | string                  |                       | Component class name                           |
| `confirmColor`         | `Button.Colors`         | `Button.Colors.BRAND` | Primary button color                           |
| `confirmText`          | string                  | `Okay`                | Text for the cancel button                     |
| `onCancel`             | () => void              |                       | Function ran on modal cancel                   |
| `onCloseCallback`      | () => void              |                       | Function ran on modal close                    |
| `onConfirm`            | () => void              |                       | Function ran when the primary button is used   |
| `onConfirmSecondary`   | () => void              |                       | Function ran when the secondary button is used |
| `secondaryConfirmText` | string                  |                       | Text for the secondary button                  |
| `title`                | string                  |                       | Modal title                                    |
| `titleClassName`       | string                  |                       | Title element class name                       |

`ModalOptions` Props:

| Name              | Type       | Default | Description                                  |
| ----------------- | ---------- | ------- | -------------------------------------------- |
| `modalKey`        | string     |         | Modal key                                    |
| `onCloseCallback` | () => void |         | Function ran when the modal gets closed      |
| `onCloseRequest`  | () => void |         | Function ran when clicking outside the modal |

`ModalProps` Props:

| Name              | Type               | Default | Description                             |
| ----------------- | ------------------ | ------- | --------------------------------------- |
| `onClose`         | (): Promise<void\> |         | Function ran when the modal gets closed |
| `transitionState` | string             |         | Modal state                             |

### `parser`

### `toast`

Example:

```tsx
import { common } from "replugged";
const { toast } = common;

toast.toast("Toast text", toast.Kind.FAILURE, { duration: 5000 });
```

Enums:

| Enum             | Description                                                       |
| ---------------- | ----------------------------------------------------------------- |
| `toast.Kind`     | Toast types <br />`MESSAGE` \| `SUCCESS` \| `FAILURE` \| `CUSTOM` |
| `toast.Position` | Toast positions <br />`TOP` \| `BOTTOM`                           |

Functions:

| Name    | Parameters                                                                                                      | Return Type | Description                                                                  |
| ------- | --------------------------------------------------------------------------------------------------------------- | ----------- | ---------------------------------------------------------------------------- |
| `toast` | `content`: string \| ReactElement \| null **(required)** <br /> `kind`: `toast.Kind` <br /> `opts`: `ToastOpts` |             | Makes a toast appear on the screen; `toast.Kind.SUCCESS` is the default type |

`ToastOpts` Props:

| Name        | Type             | Default              | Description                                            |
| ----------- | ---------------- | -------------------- | ------------------------------------------------------ |
| `component` | ReactElement     |                      | Custom toast component                                 |
| `duration`  | number           | `3000`               | How long the toast stays on the screen in milliseconds |
| `position`  | `toast.Position` | `toast.Position.TOP` | Toast position                                         |

### `typing`

Functions:

| Name          | Parameters                         | Return Type | Description                                        |
| ------------- | ---------------------------------- | ----------- | -------------------------------------------------- |
| `startTyping` | `channelId`: string **(required)** |             | Starts your typing indicator in a specific channel |
| `stopTyping`  | `channelId`: string **(required)** |             | Stops your typing indicator in a specific channel  |

## External Libraries

### `hljs`

**highlight.js** | [Documentation](https://highlightjs.org/usage/)

### `lodash`

**Lodash** | [Documentation](https://lodash.com/docs)

### `ReactDOM`

**ReactDOM** | [Documentation](https://reactjs.org/docs/react-dom.html)

### `React`

**React** | [Documentation](https://reactjs.org/docs/react-api.html)
